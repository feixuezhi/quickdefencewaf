
RULE: DENY_IP "FALSE"
RULE: TRIGGER_ACTION "LOG"
RULE: BLOCK_ACTION "SLEEP=50;HTTP_CODE=301;REDIRECT=http://images.sodahead.com/polls/002874377/348775559_5034317796_blocked_xlarge_xlarge.jpeg"
#RULE: USER_DENY_SCORE 500


RULE: ALLOWED_METHODS "GET, POST"
RULE: LOAD_PATTERNS "SQL_PATTERNS=/mnt/hgfs/myscanner/Extras/WAF/Rules/sql_patterns.txt"
RULE: LOAD_PATTERNS "XSS_PATTERNS=/mnt/hgfs/myscanner/Extras/WAF/Rules/xss_patterns.txt"

#RULE: LOAD_FILTERS "SQL_FILTERS=/mnt/hgfs/myscanner/Extras/WAF/Rules/sql_filters.txt"
#RULE: LOAD_FILTERS "ERROR_FILTERS=/mnt/hgfs/myscanner/Extras/WAF/Rules/error_filters.txt"

RULE: FILTER "<SQL_FILTERS>"

RULE: SQL_INJECTION "/"
	TRIGGER_ACTION: "BLOCK"
	DENY_IP: "TRUE"
	MATCHES: HEADERS,POST_DATA,QUERY_STRING,URI,COOKIES<!__utm>
	PATTERN: "<SQL_PATTERNS>"
		SCORE: 100
	MATCHES: HEADERS,POST_DATA,QUERY_STRING,URI,COOKIES,HEADER_NAMES,QUERY_FIELDS,POST_FIELDS,POST_BODY,COOKIE_NAMES,METHOD
	PATTERN: "select.*from"
		SCORE: 500

RULE: CONTENT_LENGTH "/"
	TRIGGER_ACTION: "BLOCK"
	MATCHES: HEADERS<User-Agent>
	PATTERN: "<NULL>"
		SCORE: 50
	MATCHES: METHOD
	PATTERN: "post"
		SCORE: 50
		
RULE: CROSS-SITE-SCRIPTING "/"
	TRIGGER_ACTION: "BLOCK"
	DENY_IP: "TRUE"
	MATCHES: HEADERS,POST_DATA,QUERY_STRING,URI,COOKIES
	PATTERN: ".*<script"
		SCORE: 100
	MATCHES: HEADERS,POST_DATA,QUERY_STRING,URI,COOKIES
	PATTERN: "onclick"
		SCORE: 100
		